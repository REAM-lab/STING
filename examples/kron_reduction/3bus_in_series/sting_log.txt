2026-01-17 22:09:37
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/paul/Documents/STING/examples/kron_reduction/3bus/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 2 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.0000000000e+02    nrm: 1e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.0000000000e+02    nrm: 1e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.04 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 100.00.
> Time spent by solver: 0.04 seconds.
2026-01-17 22:09:47
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/paul/Documents/STING/examples/kron_reduction/3bus/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 2 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.0000000000e+02    nrm: 1e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.0000000000e+02    nrm: 1e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.04 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 100.00.
> Time spent by solver: 0.04 seconds.
2026-01-17 22:10:32
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/paul/Documents/STING/examples/kron_reduction/3bus/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 2 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.0000000000e+02    nrm: 1e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.0000000000e+02    nrm: 1e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.04 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 100.00.
> Time spent by solver: 0.04 seconds.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.05 seconds. 

> Completed in 0.05 seconds. 


>> Run completed in 0.06 seconds.

2026-01-17 22:22:19
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/paul/Documents/STING/examples/kron_reduction/3bus/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 2 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
2026-01-18 10:52:37
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 2 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.0000000000e+02    nrm: 1e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.0000000000e+02    nrm: 1e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.05 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 100.00.
> Time spent by solver: 0.05 seconds.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.06 seconds. 

> Completed in 0.07 seconds. 


>> Run completed in 0.08 seconds.

2026-01-18 10:52:53
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 2 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
2026-01-18 11:18:17
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.02 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Time spent by solver: 0.02 seconds.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.03 seconds. 

> Completed in 0.03 seconds. 


>> Run completed in 0.04 seconds.

2026-01-18 11:18:17
2026-01-18 11:18:17
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'quadratic', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': True, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'quadratic', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': True, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
Rule failed when generating expression for Constraint cMaxGenVar with index (Generator(id=0, name='1', technology='solar', bus='1', site='solar', cap_existing_power_MW=100.0, cap_max_power_MW=150.0, cost_fixed_power_USDperkW=10.0, cost_variable_USDperMWh=0.0, c0_USD=0.0, c1_USDperMWh=0.01, c2_USDperMWh2=0.0, bus_id=0, expand_capacity=True), Scenario(name='1', probability=1.0, id=0), Timepoint(name='1', timeseries='winter', id=0, timeseries_id=0, weight=1.0, duration_hr=1.0, prev_timepoint_id=2)):
KeyError: ('solar', '1', '1')
Rule failed when generating expression for Constraint cMaxGenVar with index (Generator(id=0, name='1', technology='solar', bus='1', site='solar', cap_existing_power_MW=100.0, cap_max_power_MW=150.0, cost_fixed_power_USDperkW=10.0, cost_variable_USDperMWh=0.0, c0_USD=0.0, c1_USDperMWh=0.01, c2_USDperMWh2=0.0, bus_id=0, expand_capacity=True), Scenario(name='1', probability=1.0, id=0), Timepoint(name='1', timeseries='winter', id=0, timeseries_id=0, weight=1.0, duration_hr=1.0, prev_timepoint_id=2)):
KeyError: ('solar', '1', '1')
Constructing component 'cMaxGenVar' from data=None failed:
    KeyError: ('solar', '1', '1')
Constructing component 'cMaxGenVar' from data=None failed:
    KeyError: ('solar', '1', '1')
2026-01-18 11:19:17
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.02 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Time spent by solver: 0.02 seconds.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.03 seconds. 

> Completed in 0.03 seconds. 


>> Run completed in 0.04 seconds.

2026-01-18 11:19:17
2026-01-18 11:19:17
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'quadratic', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': True, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'quadratic', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': True, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Maximum flow constraints per bus
 - Maximum flow constraints per bus
   Size: 6 constraints
   Size: 6 constraints
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 28              
  Constraints            : 28              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 27              
  Scalar variables       : 27              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 1
Freed constraints in eliminator : 1
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:19:51
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.02 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Time spent by solver: 0.02 seconds.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.03 seconds. 

> Completed in 0.03 seconds. 


>> Run completed in 0.04 seconds.

2026-01-18 11:19:51
2026-01-18 11:19:51
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'quadratic', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'quadratic', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 22              
  Constraints            : 22              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 27              
  Scalar variables       : 27              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 1
Freed constraints in eliminator : 1
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:21:52
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.02 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Time spent by solver: 0.02 seconds.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.03 seconds. 

> Completed in 0.03 seconds. 


>> Run completed in 0.04 seconds.

2026-01-18 11:21:52
2026-01-18 11:21:52
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'quadratic', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'quadratic', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 22              
  Constraints            : 22              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 27              
  Scalar variables       : 27              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 1
Freed constraints in eliminator : 1
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:22:33
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Decision variables of bus angles.
   Size: 4 variables.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
Problem
  Name                   :                 
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Time spent by solver: 0.03 seconds.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.03 seconds. 

> Completed in 0.03 seconds. 


>> Run completed in 0.04 seconds.

2026-01-18 11:22:33
2026-01-18 11:22:33
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 22              
  Constraints            : 22              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 27              
  Scalar variables       : 27              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:24:16
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 4 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 0 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 31              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 33              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 7               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 16                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 15                after factor           : 18              
Factor     - dense dim.             : 0                 flops                  : 1.14e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   3.3e+02  5.1e-01  3.5e+01  0.00e+00   4.123546030e+00   1.396414401e+01   4.5e+01  0.00  
1   9.0e+01  1.4e-01  9.5e+00  4.01e+00   1.981484808e+00   2.362760408e+01   1.2e+01  0.00  
2   7.4e+00  1.1e-02  7.8e-01  1.16e+00   1.675916894e+00   3.099404178e+00   1.0e+00  0.00  
3   2.2e+00  3.4e-03  2.3e-01  1.05e+00   1.343029345e+00   1.725988179e+00   3.0e-01  0.00  
4   1.4e-02  2.2e-05  1.5e-03  1.02e+00   1.250666820e+00   1.251868356e+00   1.9e-03  0.00  
5   1.5e-05  2.3e-08  1.6e-06  1.00e+00   1.250003709e+00   1.250004996e+00   2.0e-06  0.00  
6   3.1e-06  4.9e-09  3.3e-07  9.87e-01   1.250001810e+00   1.250002045e+00   4.3e-07  0.00  
7   1.9e-08  2.8e-11  1.9e-09  1.00e+00   1.250001502e+00   1.250001503e+00   2.4e-09  0.00  
8   2.0e-12  2.8e-15  1.9e-13  1.00e+00   1.250001500e+00   1.250001500e+00   2.4e-13  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.2500015000e+00    nrm: 2e+02    Viol.  con: 6e-13    var: 0e+00  
  Dual.    obj: 1.2500015000e+00    nrm: 5e-03    Viol.  con: 9e-16    var: 4e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.2500015000e+00    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.2500015000e+00    nrm: 5e-03    Viol.  con: 2e-16    var: 2e-15  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 1250001.50 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 11:24:16
2026-01-18 11:24:16
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:24:16
2026-01-18 11:24:16
2026-01-18 11:24:16
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 22              
  Constraints            : 22              
  Constraints            : 22              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 27              
  Scalar variables       : 27              
  Scalar variables       : 27              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 6e-20  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:27:25
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': False, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 4 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 0 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 31              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 24              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 7
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_INFEASIBLE
  Solution status : PRIMAL_INFEASIBLE_CER
  Dual.    obj: 5.0000000000e+01    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
Loading a SolverResults object with a warning status into model.name="unknown";
  - termination condition: infeasible
  - message from solver:  Problem is primal infeasible. The solution is a certificate of primal infeasibility.

Basic solution summary
  Problem status  : PRIMAL_INFEASIBLE
  Solution status : PRIMAL_INFEASIBLE_CER
  Dual.    obj: 5.0000000000e+01    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: warning, termination condition: infeasible.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 11:27:25
2026-01-18 11:27:25
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:27:25
2026-01-18 11:27:25
2026-01-18 11:27:25
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': False, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': False, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': False, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
   Size: 4 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 22              
  Constraints            : 22              
  Constraints            : 22              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 21              
  Scalar variables       : 21              
  Scalar variables       : 21              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Loading a SolverResults object with a warning status into model.name="unknown";
  - termination condition: infeasible
  - message from solver:  Problem is primal infeasible. The solution is a certificate of primal infeasibility.
Loading a SolverResults object with a warning status into model.name="unknown";
  - termination condition: infeasible
  - message from solver:  Problem is primal infeasible. The solution is a certificate of primal infeasibility.
Presolve started.
Loading a SolverResults object with a warning status into model.name="unknown";
  - termination condition: infeasible
  - message from solver:  Problem is primal infeasible. The solution is a certificate of primal infeasibility.
Presolve started.
Presolve started.
Eliminator - tries                  : 0                 time                   : 0.00            
Eliminator - tries                  : 0                 time                   : 0.00            
Eliminator - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_INFEASIBLE
  Problem status  : PRIMAL_INFEASIBLE
  Problem status  : PRIMAL_INFEASIBLE
  Solution status : PRIMAL_INFEASIBLE_CER
  Solution status : PRIMAL_INFEASIBLE_CER
  Solution status : PRIMAL_INFEASIBLE_CER
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_INFEASIBLE
  Problem status  : PRIMAL_INFEASIBLE
  Problem status  : PRIMAL_INFEASIBLE
  Solution status : PRIMAL_INFEASIBLE_CER
  Solution status : PRIMAL_INFEASIBLE_CER
  Solution status : PRIMAL_INFEASIBLE_CER
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: warning, termination condition: infeasible.
> Solver finished with status: warning, termination condition: infeasible.
> Solver finished with status: warning, termination condition: infeasible.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.04 seconds.


>> Run completed in 0.04 seconds.


>> Run completed in 0.04 seconds.

2026-01-18 11:28:32
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 4 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 0 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 31              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 33              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 7               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 16                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 15                after factor           : 18              
Factor     - dense dim.             : 0                 flops                  : 1.14e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   3.3e+02  5.1e-01  3.5e+01  0.00e+00   4.123542646e+00   1.396414102e+01   4.5e+01  0.00  
1   9.0e+01  1.4e-01  9.5e+00  4.01e+00   1.981483320e+00   2.362760250e+01   1.2e+01  0.00  
2   7.4e+00  1.1e-02  7.8e-01  1.16e+00   1.675915378e+00   3.099405720e+00   1.0e+00  0.00  
3   2.2e+00  3.4e-03  2.3e-01  1.05e+00   1.343026142e+00   1.725978369e+00   3.0e-01  0.00  
4   1.4e-02  2.2e-05  1.5e-03  1.02e+00   1.250665291e+00   1.251866765e+00   1.9e-03  0.00  
5   1.5e-05  2.3e-08  1.6e-06  1.00e+00   1.250002209e+00   1.250003496e+00   2.0e-06  0.00  
6   3.1e-06  4.9e-09  3.3e-07  9.87e-01   1.250000310e+00   1.250000545e+00   4.3e-07  0.00  
7   1.8e-08  2.8e-11  1.9e-09  1.00e+00   1.250000002e+00   1.250000003e+00   2.4e-09  0.00  
8   4.5e-09  3.0e-15  1.8e-11  1.00e+00   1.250000000e+00   1.250000000e+00   2.4e-13  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.2500000000e+00    nrm: 2e+02    Viol.  con: 2e-09    var: 0e+00  
  Dual.    obj: 1.2500000000e+00    nrm: 5e-03    Viol.  con: 9e-16    var: 1e-14  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.2500000000e+00    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.2500000000e+00    nrm: 5e-03    Viol.  con: 2e-16    var: 1e-14  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 1250000.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.07 seconds.

2026-01-18 11:28:32
2026-01-18 11:28:32
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:28:33
2026-01-18 11:28:33
2026-01-18 11:28:33
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 22              
  Constraints            : 22              
  Constraints            : 22              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 27              
  Scalar variables       : 27              
  Scalar variables       : 27              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:29:54
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 4 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 0 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 31              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 33              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 9               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 19                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 21                after factor           : 27              
Factor     - dense dim.             : 0                 flops                  : 1.73e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   3.4e+02  5.7e-01  3.4e+01  0.00e+00   3.853024944e+00   1.355624781e+01   4.4e+01  0.00  
1   8.9e+01  1.5e-01  9.0e+00  4.10e+00   1.524734610e+00   2.456550816e+01   1.2e+01  0.00  
2   1.4e+01  2.3e-02  1.4e+00  1.17e+00   1.111123769e+00   4.024610273e+00   1.8e+00  0.00  
3   1.5e+00  2.6e-03  1.6e-01  1.11e+00   5.031806496e-01   7.448256573e-01   2.0e-01  0.00  
4   5.5e-01  9.3e-04  5.5e-02  1.03e+00   4.383772086e-01   5.169614379e-01   7.1e-02  0.00  
5   2.3e-02  3.9e-05  2.3e-03  1.02e+00   3.766757463e-01   3.796452635e-01   3.0e-03  0.00  
6   1.2e-05  2.1e-08  1.2e-06  1.00e+00   3.750024446e-01   3.750038895e-01   1.6e-06  0.00  
7   1.5e-06  2.6e-09  1.5e-07  1.00e+00   3.750011195e-01   3.750012669e-01   2.0e-07  0.00  
8   1.5e-10  2.6e-13  1.6e-11  1.00e+00   3.750010000e-01   3.750010000e-01   2.0e-11  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 3.7500100001e-01    nrm: 2e+02    Viol.  con: 5e-11    var: 0e+00  
  Dual.    obj: 3.7500100001e-01    nrm: 5e-03    Viol.  con: 7e-14    var: 8e-14  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 3.7500100000e-01    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 3.7500100002e-01    nrm: 5e-03    Viol.  con: 8e-14    var: 8e-14  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 375001.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 11:29:54
2026-01-18 11:29:54
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:29:54
2026-01-18 11:29:54
2026-01-18 11:29:54
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 22              
  Constraints            : 22              
  Constraints            : 22              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 27              
  Scalar variables       : 27              
  Scalar variables       : 27              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:31:30
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 4 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 0 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 31              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 33              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 7               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 16                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 15                after factor           : 18              
Factor     - dense dim.             : 0                 flops                  : 1.14e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   3.3e+02  5.4e-01  3.5e+01  0.00e+00   3.882038685e+00   1.371846741e+01   4.5e+01  0.00  
1   8.9e+01  1.4e-01  9.4e+00  4.00e+00   1.865051148e+00   2.348437024e+01   1.2e+01  0.00  
2   1.3e+01  2.1e-02  1.4e+00  1.16e+00   1.551537081e+00   4.234163579e+00   1.7e+00  0.00  
3   2.3e+00  3.7e-03  2.4e-01  1.07e+00   1.173533846e+00   1.593399282e+00   3.1e-01  0.00  
4   1.7e-01  2.8e-04  1.8e-02  1.01e+00   1.111320377e+00   1.140951578e+00   2.4e-02  0.00  
5   5.6e-04  9.1e-07  5.9e-05  9.94e-01   1.100020642e+00   1.100018154e+00   7.6e-05  0.00  
6   1.0e-05  1.6e-08  1.1e-06  1.00e+00   1.100001798e+00   1.100001754e+00   1.4e-06  0.00  
7   2.1e-06  3.4e-09  2.2e-07  9.88e-01   1.100000230e+00   1.100000216e+00   2.8e-07  0.00  
8   4.2e-08  6.8e-11  4.4e-09  1.00e+00   1.100000006e+00   1.100000006e+00   5.7e-09  0.00  
9   4.5e-12  7.2e-15  4.6e-13  1.00e+00   1.100000000e+00   1.100000000e+00   6.0e-13  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.1000000000e+00    nrm: 2e+02    Viol.  con: 1e-12    var: 0e+00  
  Dual.    obj: 1.1000000000e+00    nrm: 5e-03    Viol.  con: 2e-15    var: 6e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 1.1000000000e+00    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.1000000000e+00    nrm: 5e-03    Viol.  con: 7e-16    var: 3e-15  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 1100000.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 11:31:30
2026-01-18 11:31:30
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:31:30
2026-01-18 11:31:30
2026-01-18 11:31:30
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Added 1 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 4 variables
   Size: 4 variables
   Size: 4 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 22              
  Constraints            : 22              
  Constraints            : 22              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 27              
  Scalar variables       : 27              
  Scalar variables       : 27              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.04 seconds.


>> Run completed in 0.04 seconds.


>> Run completed in 0.04 seconds.

2026-01-18 11:33:02
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 7               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 18                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 15                after factor           : 18              
Factor     - dense dim.             : 0                 flops                  : 1.18e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.0e+02  6.4e-01  3.8e+01  0.00e+00   3.249961007e+00   1.287051948e+01   4.7e+01  0.00  
1   1.2e+02  1.9e-01  1.1e+01  4.37e+00   1.364969501e+00   2.711761911e+01   1.4e+01  0.00  
2   1.4e+01  2.3e-02  1.3e+00  1.17e+00   1.032213972e+00   3.576318947e+00   1.7e+00  0.00  
3   3.1e+00  5.0e-03  2.9e-01  1.07e+00   5.254988327e-01   1.023722120e+00   3.7e-01  0.00  
4   7.6e-01  1.2e-03  7.3e-02  1.02e+00   3.720281721e-01   4.869670164e-01   9.1e-02  0.00  
5   3.2e-02  5.1e-05  3.0e-03  1.00e+00   3.539603346e-01   3.574886614e-01   3.8e-03  0.00  
6   4.3e-05  6.9e-08  4.1e-06  1.00e+00   3.515039565e-01   3.515073388e-01   5.1e-06  0.00  
7   9.9e-06  1.6e-08  9.4e-07  1.00e+00   3.515016557e-01   3.515024045e-01   1.2e-06  0.00  
8   1.8e-06  2.8e-09  1.7e-07  1.00e+00   3.515007325e-01   3.515008472e-01   2.1e-07  0.00  
9   2.9e-09  4.7e-12  2.8e-10  1.00e+00   3.515006002e-01   3.515006003e-01   3.5e-10  0.00  
10  2.4e-13  4.7e-16  2.7e-14  1.00e+00   3.515006000e-01   3.515006000e-01   3.5e-14  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 2             Time: 0.00        
Dual.            Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 3.5150060000e-01    nrm: 2e+02    Viol.  con: 1e-13    var: 0e+00  
  Dual.    obj: 3.5150060000e-01    nrm: 5e-03    Viol.  con: 1e-16    var: 2e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 3.5150060000e-01    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 3.5150060000e-01    nrm: 5e-03    Viol.  con: 2e-17    var: 2e-15  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 351500.60 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 11:33:02
2026-01-18 11:33:02
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:33:02
2026-01-18 11:33:02
2026-01-18 11:33:02
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 25              
  Constraints            : 25              
  Constraints            : 25              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:33:59
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 11:33:59
2026-01-18 11:33:59
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:33:59
2026-01-18 11:33:59
2026-01-18 11:33:59
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 25              
  Constraints            : 25              
  Constraints            : 25              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:47:25
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 11:47:25
2026-01-18 11:47:25
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:47:25
2026-01-18 11:47:25
2026-01-18 11:47:25
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 25              
  Constraints            : 25              
  Constraints            : 25              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 2.0000000000e+00    nrm: 2e+02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+00    nrm: 1e-02    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Objective value: 2000000.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 11:48:47
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
2026-01-18 11:48:56
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
2026-01-18 11:49:02
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.03 seconds. 


>> Run completed in 0.10 seconds.

2026-01-18 11:49:02
2026-01-18 11:49:02
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
2026-01-18 11:49:09
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.05 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.04 seconds. 

> Completed in 0.06 seconds. 


>> Run completed in 0.13 seconds.

2026-01-18 11:49:09
2026-01-18 11:49:09
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 11:49:09
2026-01-18 11:49:09
2026-01-18 11:49:09
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

2026-01-18 12:23:07
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.10 seconds.

2026-01-18 12:23:07
2026-01-18 12:23:07
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
2026-01-18 12:25:53
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.07 seconds. 


>> Run completed in 0.14 seconds.

2026-01-18 12:25:53
2026-01-18 12:25:53
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.03 seconds.


>> Run completed in 0.03 seconds.

2026-01-18 12:25:53
2026-01-18 12:25:53
2026-01-18 12:25:53
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

2026-01-18 12:28:19
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.10 seconds.

2026-01-18 12:28:19
2026-01-18 12:28:19
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.06 seconds. 

> Completed in 0.06 seconds. 


>> Run completed in 0.07 seconds.


>> Run completed in 0.07 seconds.

2026-01-18 12:28:19
2026-01-18 12:28:19
2026-01-18 12:28:19
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

2026-01-18 12:28:30
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.03 seconds. 


>> Run completed in 0.10 seconds.

2026-01-18 12:28:30
2026-01-18 12:28:30
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.06 seconds. 

> Completed in 0.06 seconds. 


>> Run completed in 0.07 seconds.


>> Run completed in 0.07 seconds.

2026-01-18 12:28:30
2026-01-18 12:28:30
2026-01-18 12:28:30
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 25              
  Constraints            : 25              
  Constraints            : 25              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Constraints            : 8               
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.

2026-01-18 12:40:29
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 12:40:29
2026-01-18 12:40:29
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 12:40:29
2026-01-18 12:40:29
2026-01-18 12:40:29
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 28              
  Constraints            : 28              
  Constraints            : 28              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Constraints            : 8               
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 12:43:27
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.06 seconds. 


>> Run completed in 0.14 seconds.

2026-01-18 12:43:28
2026-01-18 12:43:28
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.03 seconds.


>> Run completed in 0.03 seconds.

2026-01-18 12:43:28
2026-01-18 12:43:28
2026-01-18 12:43:28
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

2026-01-18 12:45:38
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.05 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.03 seconds. 


>> Run completed in 0.10 seconds.

2026-01-18 12:45:38
2026-01-18 12:45:38
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.05 seconds. 

> Completed in 0.05 seconds. 


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.

2026-01-18 12:45:38
2026-01-18 12:45:38
2026-01-18 12:45:38
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

2026-01-18 12:45:52
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 1 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 34              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 4e-19    var: 8e-09  
> Time spent by solver: 0.05 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.07 seconds. 


>> Run completed in 0.14 seconds.

2026-01-18 12:45:52
2026-01-18 12:45:52
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.03 seconds.


>> Run completed in 0.03 seconds.

2026-01-18 12:45:52
2026-01-18 12:45:52
2026-01-18 12:45:52
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 1 constraints
   Size: 1 constraints
   Size: 1 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 28              
  Constraints            : 28              
  Constraints            : 28              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 8               
Optimizer  - Constraints            : 8               
Optimizer  - Constraints            : 8               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Scalar variables       : 20                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - nonzeros before factor : 17                after factor           : 20              
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
Factor     - dense dim.             : 0                 flops                  : 1.30e+02        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
0   4.1e+02  6.8e-01  3.6e+01  0.00e+00   3.463478084e+00   1.290784876e+01   4.6e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
1   1.1e+02  1.9e-01  1.0e+01  4.47e+00   1.226118151e+00   2.854207839e+01   1.3e+01  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
2   1.9e+01  3.2e-02  1.7e+00  1.15e+00   7.561038459e-01   4.742030613e+00   2.2e+00  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
3   1.7e+00  2.8e-03  1.5e-01  1.08e+00   4.765309260e-02   3.126384993e-01   1.9e-01  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
4   1.2e-01  1.9e-04  1.0e-02  1.01e+00   1.332461346e-02   2.614753340e-02   1.3e-02  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
5   1.3e-02  2.2e-05  1.2e-03  1.00e+00   3.611141188e-03   5.015519196e-03   1.5e-03  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
6   6.0e-04  9.8e-07  5.3e-05  1.00e+00   2.251750286e-03   2.302287720e-03   6.7e-05  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
7   4.1e-05  6.7e-08  3.6e-06  1.00e+00   2.204836285e-03   2.208265241e-03   4.6e-06  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
8   5.9e-06  9.7e-09  5.2e-07  1.01e+00   2.200867869e-03   2.201229285e-03   6.5e-07  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
9   4.1e-07  6.8e-10  3.6e-08  1.01e+00   2.200050734e-03   2.200073948e-03   4.6e-08  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
10  1.3e-10  2.1e-13  1.1e-11  1.00e+00   2.200000018e-03   2.200000018e-03   1.4e-11  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
11  3.6e-10  2.3e-17  1.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   1.4e-15  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 1e-10    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  
  Dual.    obj: 2.2000000000e-03    nrm: 1e-02    Viol.  con: 6e-18    var: 6e-18  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
  Dual.    obj: 2.2008481667e-03    nrm: 1e-02    Viol.  con: 0e+00    var: 8e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.

2026-01-18 12:46:52
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 3e-19    var: 9e-09  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.07 seconds. 


>> Run completed in 0.14 seconds.

2026-01-18 12:46:52
2026-01-18 12:46:52
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 12:46:52
2026-01-18 12:46:52
2026-01-18 12:46:52
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 27              
  Constraints            : 27              
  Constraints            : 27              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 12:54:02
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 3e-19    var: 9e-09  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
2026-01-18 12:54:37
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 3e-19    var: 9e-09  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
2026-01-18 12:57:37
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 3e-19    var: 9e-09  
> Time spent by solver: 0.24 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.28 seconds.

2026-01-18 12:57:38
2026-01-18 12:57:38
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 12:57:38
2026-01-18 12:57:38
2026-01-18 12:57:38
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 27              
  Constraints            : 27              
  Constraints            : 27              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.

2026-01-18 13:01:59
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 8e-15  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 8e-15    var: 0e+00  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 3e-19    var: 9e-09  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.

2026-01-18 13:01:59
2026-01-18 13:01:59
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 13:01:59
2026-01-18 13:01:59
2026-01-18 13:01:59
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Primal.  obj: 2.0000000000e+02    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 2.0000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 200.00.
> Objective value: 200.00.
> Objective value: 200.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 27              
  Constraints            : 27              
  Constraints            : 27              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
0   4.1e+02  6.7e-01  3.8e+01  0.00e+00   2.703581512e+00   1.238194724e+01   4.8e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
1   1.1e+02  1.8e-01  1.0e+01  4.39e+00   9.891899792e-01   2.789247478e+01   1.3e+01  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
2   2.0e+01  3.2e-02  1.8e+00  1.14e+00   6.286888875e-01   4.750240399e+00   2.3e+00  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  1.9e-01  1.08e+00   4.399749327e-02   3.738171596e-01   2.4e-01  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
4   2.4e-01  4.0e-04  2.3e-02  1.01e+00   2.348991526e-02   5.198152638e-02   2.8e-02  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
5   2.0e-02  3.3e-05  1.9e-03  1.00e+00   4.229289151e-03   6.559980060e-03   2.3e-03  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
6   2.3e-03  3.8e-06  2.2e-04  1.00e+00   2.394012124e-03   2.616828421e-03   2.7e-04  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
7   5.1e-05  8.3e-08  4.7e-06  1.00e+00   2.205650491e-03   2.210458297e-03   5.9e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
8   9.1e-06  1.5e-08  8.4e-07  1.01e+00   2.201261033e-03   2.201918830e-03   1.1e-06  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
9   8.5e-07  1.4e-09  7.9e-08  1.01e+00   2.200095789e-03   2.200149777e-03   9.9e-08  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
10  6.8e-10  1.1e-12  6.3e-11  1.00e+00   2.200000094e-03   2.200000088e-03   7.9e-11  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
11  2.4e-12  1.1e-16  6.3e-15  1.00e+00   2.200000000e-03   2.200000000e-03   7.9e-15  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 7e-13    var: 0e+00  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  
  Dual.    obj: 2.2000000000e-03    nrm: 5e-03    Viol.  con: 3e-17    var: 3e-17  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Primal.  obj: 2.2000000000e-03    nrm: 2e+02    Viol.  con: 4e-15    var: 0e+00  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
  Dual.    obj: 2.2009104866e-03    nrm: 5e-03    Viol.  con: 0e+00    var: 9e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Objective value: 2200.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 13:06:56
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Load shedding cost expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 1e-14  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 1e-19    var: 7e-09  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.07 seconds.

2026-01-18 13:06:56
2026-01-18 13:06:56
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.00 seconds. 

> Completed in: 0.00 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 150.00.
> Objective value: 150.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 13:06:56
2026-01-18 13:06:56
2026-01-18 13:06:56
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 150.00.
> Objective value: 150.00.
> Objective value: 150.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 27              
  Constraints            : 27              
  Constraints            : 27              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Objective value: 251700.00 USD.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.


>> Run completed in 0.05 seconds.

2026-01-18 13:56:18
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 6
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_INFEASIBLE
  Solution status : PRIMAL_INFEASIBLE_CER
Loading a SolverResults object with a warning status into model.name="unknown";
  - termination condition: infeasible
  - message from solver:  Problem is primal infeasible. The solution is a certificate of primal infeasibility.
  Dual.    obj: 1.0000000002e+00    nrm: 2e-02    Viol.  con: 0e+00    var: 1e-14  

Basic solution summary
  Problem status  : PRIMAL_INFEASIBLE
  Solution status : PRIMAL_INFEASIBLE_CER
  Dual.    obj: 1.0000000002e+00    nrm: 2e-02    Viol.  con: 0e+00    var: 1e-14  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: warning, termination condition: infeasible.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.07 seconds. 


>> Run completed in 0.15 seconds.

2026-01-18 13:56:18
2026-01-18 13:56:18
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.01 seconds.


>> Run completed in 0.01 seconds.

2026-01-18 13:56:18
2026-01-18 13:56:18
2026-01-18 13:56:18
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 21              
  Constraints            : 21              
  Constraints            : 21              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 25              
  Scalar variables       : 25              
  Scalar variables       : 25              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
2026-01-18 13:57:40
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 6
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_INFEASIBLE
  Solution status : PRIMAL_INFEASIBLE_CER
  Dual.    obj: 1.0000000002e+00    nrm: 2e-02    Viol.  con: 0e+00    var: 1e-14  

Basic solution summary
  Problem status  : PRIMAL_INFEASIBLE
  Solution status : PRIMAL_INFEASIBLE_CER
  Dual.    obj: 1.0000000002e+00    nrm: 2e-02    Viol.  con: 0e+00    var: 1e-14  
Loading a SolverResults object with a warning status into model.name="unknown";
  - termination condition: infeasible
  - message from solver:  Problem is primal infeasible. The solution is a certificate of primal infeasibility.
> Time spent by solver: 0.05 seconds.
> Solver finished with status: warning, termination condition: infeasible.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.10 seconds.

2026-01-18 13:57:40
2026-01-18 13:57:40
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.

2026-01-18 13:57:40
2026-01-18 13:57:40
2026-01-18 13:57:40
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 21              
  Constraints            : 21              
  Constraints            : 21              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 25              
  Scalar variables       : 25              
  Scalar variables       : 25              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
2026-01-18 13:57:50
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
2026-01-18 13:58:37
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
2026-01-18 13:59:42
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
2026-01-18 14:00:02
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
2026-01-18 14:00:08
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
Rule failed for Expression 'eShedCostPerTp' with index Timepoint(id=0, name='1', timeseries='winter'):
KeyError: "Index '('3', Scenario(name='1', probability=1.0, id=0), Timepoint(id=0, name='1', timeseries='winter'))' is not valid for indexed component 'vSHED'"
Constructing component 'eShedCostPerTp' from data=None failed:
    KeyError: "Index '('3', Scenario(name='1', probability=1.0, id=0), Timepoint(id=0, name='1', timeseries='winter'))' is not valid for indexed component 'vSHED'"
2026-01-18 14:00:56
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
Rule failed for Expression 'eShedCostPerTp' with index Timepoint(id=0, name='1', timeseries='winter'):
KeyError: "Index '('3', Scenario(name='1', probability=1.0, id=0), Timepoint(id=0, name='1', timeseries='winter'))' is not valid for indexed component 'vSHED'"
Constructing component 'eShedCostPerTp' from data=None failed:
    KeyError: "Index '('3', Scenario(name='1', probability=1.0, id=0), Timepoint(id=0, name='1', timeseries='winter'))' is not valid for indexed component 'vSHED'"
2026-01-18 14:01:45
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   1.9e+02  4.7e+01  5.8e+01  0.00e+00   5.939745551e+01   2.012468091e+00   9.2e-01  0.00  
1   1.4e+00  3.4e-01  4.3e-01  -8.70e-01  6.721394006e+00   1.195262886e+01   6.7e-03  0.00  
2   1.3e-01  3.3e-02  4.1e-02  8.60e-01   9.448262115e-01   1.326995962e+00   6.5e-04  0.00  
3   4.3e-02  1.1e-02  1.3e-02  8.76e-01   3.500381501e-01   4.337931498e-01   2.1e-04  0.00  
4   9.6e-03  2.4e-03  3.0e-03  8.94e-01   2.629548604e-01   2.827002973e-01   4.7e-05  0.00  
5   5.6e-05  1.4e-05  1.7e-05  9.83e-01   2.521710509e-01   2.521102644e-01   2.8e-07  0.00  
6   3.2e-06  8.0e-07  9.9e-07  1.00e+00   2.517151675e-01   2.517083231e-01   1.6e-08  0.00  
7   1.0e-07  2.6e-08  3.2e-08  1.00e+00   2.517018647e-01   2.517016421e-01   5.1e-10  0.00  
8   1.4e-08  3.4e-09  4.2e-09  1.00e+00   2.517001361e-01   2.517001020e-01   6.7e-11  0.00  
9   1.3e-10  3.3e-11  4.1e-11  1.00e+00   2.517000016e-01   2.517000012e-01   6.5e-13  0.00  
10  1.3e-14  4.1e-15  4.1e-15  1.00e+00   2.517000000e-01   2.517000000e-01   6.5e-17  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 4e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 5e-16    var: 7e-14  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 8e-15  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.07 seconds. 


>> Run completed in 0.15 seconds.

2026-01-18 14:01:45
2026-01-18 14:01:45
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.01 seconds.


>> Run completed in 0.01 seconds.

2026-01-18 14:01:45
2026-01-18 14:01:45
2026-01-18 14:01:45
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 21              
  Constraints            : 21              
  Constraints            : 21              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 25              
  Scalar variables       : 25              
  Scalar variables       : 25              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
2026-01-18 14:02:28
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   1.9e+02  4.7e+01  5.8e+01  0.00e+00   5.939745551e+01   2.012468091e+00   9.2e-01  0.00  
1   1.4e+00  3.4e-01  4.3e-01  -8.70e-01  6.721394006e+00   1.195262886e+01   6.7e-03  0.00  
2   1.3e-01  3.3e-02  4.1e-02  8.60e-01   9.448262115e-01   1.326995962e+00   6.5e-04  0.00  
3   4.3e-02  1.1e-02  1.3e-02  8.76e-01   3.500381501e-01   4.337931498e-01   2.1e-04  0.00  
4   9.6e-03  2.4e-03  3.0e-03  8.94e-01   2.629548604e-01   2.827002973e-01   4.7e-05  0.00  
5   5.6e-05  1.4e-05  1.7e-05  9.83e-01   2.521710509e-01   2.521102644e-01   2.8e-07  0.00  
6   3.2e-06  8.0e-07  9.9e-07  1.00e+00   2.517151675e-01   2.517083231e-01   1.6e-08  0.00  
7   1.0e-07  2.6e-08  3.2e-08  1.00e+00   2.517018647e-01   2.517016421e-01   5.1e-10  0.00  
8   1.4e-08  3.4e-09  4.2e-09  1.00e+00   2.517001361e-01   2.517001020e-01   6.7e-11  0.00  
9   1.3e-10  3.3e-11  4.1e-11  1.00e+00   2.517000016e-01   2.517000012e-01   6.5e-13  0.00  
10  1.3e-14  4.1e-15  4.1e-15  1.00e+00   2.517000000e-01   2.517000000e-01   6.5e-17  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 4e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 5e-16    var: 7e-14  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 8e-15  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.06 seconds. 


>> Run completed in 0.15 seconds.

2026-01-18 14:02:28
2026-01-18 14:02:28
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.01 seconds.


>> Run completed in 0.01 seconds.

2026-01-18 14:02:28
2026-01-18 14:02:28
2026-01-18 14:02:28
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 21              
  Constraints            : 21              
  Constraints            : 21              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 25              
  Scalar variables       : 25              
  Scalar variables       : 25              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
2026-01-18 14:03:40
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
2026-01-18 14:06:14
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   1.9e+02  4.7e+01  5.8e+01  0.00e+00   5.939745551e+01   2.012468091e+00   9.2e-01  0.00  
1   1.4e+00  3.4e-01  4.3e-01  -8.70e-01  6.721394006e+00   1.195262886e+01   6.7e-03  0.00  
2   1.3e-01  3.3e-02  4.1e-02  8.60e-01   9.448262115e-01   1.326995962e+00   6.5e-04  0.00  
3   4.3e-02  1.1e-02  1.3e-02  8.76e-01   3.500381501e-01   4.337931498e-01   2.1e-04  0.00  
4   9.6e-03  2.4e-03  3.0e-03  8.94e-01   2.629548604e-01   2.827002973e-01   4.7e-05  0.00  
5   5.6e-05  1.4e-05  1.7e-05  9.83e-01   2.521710509e-01   2.521102644e-01   2.8e-07  0.00  
6   3.2e-06  8.0e-07  9.9e-07  1.00e+00   2.517151675e-01   2.517083231e-01   1.6e-08  0.00  
7   1.0e-07  2.6e-08  3.2e-08  1.00e+00   2.517018647e-01   2.517016421e-01   5.1e-10  0.00  
8   1.4e-08  3.4e-09  4.2e-09  1.00e+00   2.517001361e-01   2.517001020e-01   6.7e-11  0.00  
9   1.3e-10  3.3e-11  4.1e-11  1.00e+00   2.517000016e-01   2.517000012e-01   6.5e-13  0.00  
10  1.3e-14  4.1e-15  4.1e-15  1.00e+00   2.517000000e-01   2.517000000e-01   6.5e-17  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 4e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 5e-16    var: 7e-14  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 8e-15  
> Time spent by solver: 0.06 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.07 seconds. 


>> Run completed in 0.15 seconds.

2026-01-18 14:06:14
2026-01-18 14:06:14
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.01 seconds.


>> Run completed in 0.01 seconds.

2026-01-18 14:06:14
2026-01-18 14:06:14
2026-01-18 14:06:14
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Buses with either generation, load or storage: 1
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
 - Kron reduction will remove 2 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
 - Kron system has 1 buses and 0 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 21              
  Constraints            : 21              
  Constraints            : 21              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 25              
  Scalar variables       : 25              
  Scalar variables       : 25              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - tries                  : 0                 time                   : 0.00            
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - primal attempts        : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Primal.  obj: 0.0000000000e+00    nrm: 0e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 0.0000000000e+00    nrm: 1e-05    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Objective value: 0.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
2026-01-18 14:07:13
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
   Size: 9 variables
 - Decision variables of load shedding
   Size: 9 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 37              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   1.9e+02  4.7e+01  5.8e+01  0.00e+00   5.939745551e+01   2.012468091e+00   9.2e-01  0.00  
1   1.4e+00  3.4e-01  4.3e-01  -8.70e-01  6.721394006e+00   1.195262886e+01   6.7e-03  0.00  
2   1.3e-01  3.3e-02  4.1e-02  8.60e-01   9.448262115e-01   1.326995962e+00   6.5e-04  0.00  
3   4.3e-02  1.1e-02  1.3e-02  8.76e-01   3.500381501e-01   4.337931498e-01   2.1e-04  0.00  
4   9.6e-03  2.4e-03  3.0e-03  8.94e-01   2.629548604e-01   2.827002973e-01   4.7e-05  0.00  
5   5.6e-05  1.4e-05  1.7e-05  9.83e-01   2.521710509e-01   2.521102644e-01   2.8e-07  0.00  
6   3.2e-06  8.0e-07  9.9e-07  1.00e+00   2.517151675e-01   2.517083231e-01   1.6e-08  0.00  
7   1.0e-07  2.6e-08  3.2e-08  1.00e+00   2.517018647e-01   2.517016421e-01   5.1e-10  0.00  
8   1.4e-08  3.4e-09  4.2e-09  1.00e+00   2.517001361e-01   2.517001020e-01   6.7e-11  0.00  
9   1.3e-10  3.3e-11  4.1e-11  1.00e+00   2.517000016e-01   2.517000012e-01   6.5e-13  0.00  
10  1.3e-14  4.1e-15  4.1e-15  1.00e+00   2.517000000e-01   2.517000000e-01   6.5e-17  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 4e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 5e-16    var: 7e-14  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 8e-15  
> Time spent by solver: 0.05 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.05 seconds. 

> Completed in 0.06 seconds. 


>> Run completed in 0.14 seconds.

2026-01-18 14:07:13
2026-01-18 14:07:13
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 150.00.
> Objective value: 150.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 14:07:13
2026-01-18 14:07:13
2026-01-18 14:07:13
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 150.00.
> Objective value: 150.00.
> Objective value: 150.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 27              
  Constraints            : 27              
  Constraints            : 27              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Scalar variables       : 31              
  Scalar variables       : 31              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Objective value: 251700.00 USD.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.

2026-01-18 14:11:09
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
   Size: 8 variables
 - Maximum built capacity constraints
   Size: 0 constraints
 - Maximum dispatch constraints
   Size: 3 constraints
 - Capacity factor constraints
   Size: 3 constraints
 - Dispatch at bus expressions
   Size: 9 expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
   Size: 11 variables
 - Energy capacity constraints
   Size: 0 constraints
 - Power capacity constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
 - Maximum state of charge constraints
   Size: 3 constraints
 - State of charge constraints
   Size: 12 constraints
 - Storage cost per timepoint expressions
   Size: 3 expressions
 - Storage cost per period expression
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Load data lookup
 - Decision variables of bus angles
   Size: 9 variables
 - Decision variables of load shedding
   Size: 3 variables
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
   Size: 0 variables
 - Maximum and minimum flow constraints per line
   Size: 6 constraints
 - Line cost per period expression
 - Angle difference limit constraints per line
   Size: 0 constraints
 - Power balance at each bus
   Size: 9 constraints
 - Load shedding cost expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.01 seconds. 

> Solving capacity expansion model...
Problem
  Name                   :                 
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Constraints            : 33              
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Scalar variables       : 31              
  Matrix variables       : 0               
  Integer variables      : 0               

Optimizer started.
Presolve started.
Eliminator started.
Freed constraints in eliminator : 9
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker terminated.
Eliminator started.
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   1.9e+02  4.7e+01  5.8e+01  0.00e+00   5.939745551e+01   2.012468091e+00   9.2e-01  0.00  
1   1.4e+00  3.4e-01  4.3e-01  -8.70e-01  6.721394006e+00   1.195262886e+01   6.7e-03  0.00  
2   1.3e-01  3.3e-02  4.1e-02  8.60e-01   9.448262115e-01   1.326995962e+00   6.5e-04  0.00  
3   4.3e-02  1.1e-02  1.3e-02  8.76e-01   3.500381501e-01   4.337931498e-01   2.1e-04  0.00  
4   9.6e-03  2.4e-03  3.0e-03  8.94e-01   2.629548604e-01   2.827002973e-01   4.7e-05  0.00  
5   5.6e-05  1.4e-05  1.7e-05  9.83e-01   2.521710509e-01   2.521102644e-01   2.8e-07  0.00  
6   3.2e-06  8.0e-07  9.9e-07  1.00e+00   2.517151675e-01   2.517083231e-01   1.6e-08  0.00  
7   1.0e-07  2.6e-08  3.2e-08  1.00e+00   2.517018647e-01   2.517016421e-01   5.1e-10  0.00  
8   1.4e-08  3.4e-09  4.2e-09  1.00e+00   2.517001361e-01   2.517001020e-01   6.7e-11  0.00  
9   1.3e-10  3.3e-11  4.1e-11  1.00e+00   2.517000016e-01   2.517000012e-01   6.5e-13  0.00  
10  1.3e-14  4.1e-15  4.1e-15  1.00e+00   2.517000000e-01   2.517000000e-01   6.5e-17  0.00  
Basis identification started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 2             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    


Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 4e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 5e-16    var: 7e-14  

Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 3e-14    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 8e-15  
> Time spent by solver: 0.03 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/capacity_expansion
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Completed in 0.01 seconds. 

> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.08 seconds.

2026-01-18 14:11:09
2026-01-18 14:11:09
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               


Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    




Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  


Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 150.00.
> Objective value: 150.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Run completed in 0.02 seconds.


>> Run completed in 0.02 seconds.

2026-01-18 14:11:09
2026-01-18 14:11:09
2026-01-18 14:11:09
   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

   ______   __ 
  / __/ /__/ /_  _____ _
 _\ \/ __/ _// \/ / _ `/
/___/__///  /_/\_/\_, /
       /         /___/  

Version: 0.1.0 (2025-11-12)
========================================

> Initializing system ...
> Initializing system ...
> Initializing system ...
   Completed
   Completed
   Completed
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
> Loading system from CSV files from /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/inputs ...
 - 'lines.csv' ... 
 - 'lines.csv' ... 
 - 'lines.csv' ... 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Added 2 'line_pi' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'buses.csv' ... 
 - 'buses.csv' ... 
 - 'buses.csv' ... 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Added 3 'bus' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
 - 'timeseries.csv' ... 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Added 1 'ts' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
 - 'timepoints.csv' ... 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Added 3 'tp' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
 - 'scenarios.csv' ... 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Added 1 'sc' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'loads.csv' ... 
 - 'loads.csv' ... 
 - 'loads.csv' ... 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Added 3 'load' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'generators.csv' ... 
 - 'generators.csv' ... 
 - 'generators.csv' ... 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Added 2 'gen' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
 - 'capacity_factors.csv' ... 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Added 3 'cf' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
 - 'storage.csv' ... 
 - 'storage.csv' ... 
 - 'storage.csv' ... 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Added 1 'ess' components. 
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
   Completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Post system initialization completed in 0.00 seconds.
> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 

> Completed in: 0.01 seconds. 


>> Starting Kron reduction ...


>> Starting Kron reduction ...


>> Starting Kron reduction ...

{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
{'bus_neighbor_limit': None, 'tolerance': 0.0, 'find_kron_removable_buses': True, 'consider_kron_removable_bus_attribute': False, 'expand_line_capacity': False, 'cost_fixed_power_USDperkW': 1, 'line_capacity_method': 'optimization'}
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
> Initializing identify removable buses for Kron reduction ... 
 - Total number of buses: 3
 - Total number of buses: 3
 - Total number of buses: 3
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Buses with either generation, load or storage: 2
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
 - Kron reduction will remove 1 buses out of 3 total buses.
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
> Initializing reduction of the system via Kron reduction ... 
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Original system has 3 buses and 2 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
 - Kron system has 2 buses and 1 lines.
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
> Initializing estimation of line capacities for the Kron system via optimization ... 
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
SolverSettings(solver_name='mosek_direct', tee=True, solver_options={'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'})
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
> Estimating capacity for line from bus 1 to bus 3.
 - Building optimization model ...
 - Building optimization model ...
 - Building optimization model ...
 - Decision variables of bus angles.
 - Decision variables of bus angles.
 - Decision variables of bus angles.
   Size: 4 variables.
   Size: 4 variables.
   Size: 4 variables.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
 - Constraints of angle differences for original system.
   Size: 2 constraints.
   Size: 2 constraints.
   Size: 2 constraints.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
 - Constraint of angle difference for a line in the Kron system.
   Size: 1 constraints.
   Size: 1 constraints.
   Size: 1 constraints.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
 - Objective function to maximize the angle difference bound.
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
> Solving optimization model to find maximum angle difference bound...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : maximize        
  Objective sense        : maximize        
  Objective sense        : maximize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 4               
  Constraints            : 4               
  Constraints            : 4               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Scalar variables       : 5               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Freed constraints in eliminator : 2
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Eliminator - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Primal.  obj: 1.5000000000e+02    nrm: 2e+02    Viol.  con: 1e-14    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
  Dual.    obj: 1.5000000000e+02    nrm: 1e+00    Viol.  con: 0e+00    var: 0e+00  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 150.00.
> Objective value: 150.00.
> Objective value: 150.00.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
 - Exported line capacities calculated via optimization as CSV.
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 

> Completed in 0.02 seconds. 


>> Starting capacity expansion...


>> Starting capacity expansion...


>> Starting capacity expansion...

Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Solver settings: {'solver_name': 'mosek_direct', 'tee': True, 'solver_options': {'MSK_DPAR_INTPNT_TOL_PFEAS': '1e-5'}}
Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

Model settings: {'gen_costs': 'linear', 'consider_shedding': True, 'consider_single_storage_injection': False, 'consider_line_capacity': True, 'consider_bus_max_flow': False, 'consider_angle_limits': True, 'policies': []} 

> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of the optimization model for capacity expansion ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
> Initializing construction of generator variables, constraints, and costs ... 
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Sets of generators for first-stage and second-stage decisions
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
 - Decision variables of dispatch and capacity
   Size: 8 variables
   Size: 8 variables
   Size: 8 variables
 - Maximum built capacity constraints
 - Maximum built capacity constraints
 - Maximum built capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
 - Maximum dispatch constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Capacity factor constraints
 - Capacity factor constraints
 - Capacity factor constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Dispatch at bus expressions
 - Dispatch at bus expressions
 - Dispatch at bus expressions
   Size: 6 expressions
   Size: 6 expressions
   Size: 6 expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
 - Generation cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Generation cost per period expression
 - Generation cost per period expression
 - Generation cost per period expression
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
> Initializing construction of storage variables, constraints, and costs ... 
 - Decision variables
 - Decision variables
 - Decision variables
   Size: 11 variables
   Size: 11 variables
   Size: 11 variables
 - Energy capacity constraints
 - Energy capacity constraints
 - Energy capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power capacity constraints
 - Power capacity constraints
 - Power capacity constraints
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
 - Maximum charge and discharge constraints
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
 - Maximum state of charge constraints
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - State of charge constraints
 - State of charge constraints
 - State of charge constraints
   Size: 9 constraints
   Size: 9 constraints
   Size: 9 constraints
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
 - Storage cost per timepoint expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
 - Storage cost per period expression
 - Storage cost per period expression
 - Storage cost per period expression
   Size: 1 expressions
   Size: 1 expressions
   Size: 1 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
> Initializing construction of transmission variables, constraints, and costs for capacity expansion model ... 
 - Load data lookup
 - Load data lookup
 - Load data lookup
 - Decision variables of bus angles
 - Decision variables of bus angles
 - Decision variables of bus angles
   Size: 6 variables
   Size: 6 variables
   Size: 6 variables
 - Decision variables of load shedding
 - Decision variables of load shedding
 - Decision variables of load shedding
   Size: 3 variables
   Size: 3 variables
   Size: 3 variables
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Power flow per bus expressions
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Set of expandable and non-expandable lines
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
 - Decision variables of line capacity expansion
   Size: 0 variables
   Size: 0 variables
   Size: 0 variables
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
 - Maximum and minimum flow constraints per line
   Size: 3 constraints
   Size: 3 constraints
   Size: 3 constraints
 - Line cost per period expression
 - Line cost per period expression
 - Line cost per period expression
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
 - Angle difference limit constraints per line
   Size: 0 constraints
   Size: 0 constraints
   Size: 0 constraints
 - Power balance at each bus
 - Power balance at each bus
 - Power balance at each bus
   Size: 6 constraints
   Size: 6 constraints
   Size: 6 constraints
 - Load shedding cost expressions
 - Load shedding cost expressions
 - Load shedding cost expressions
   Size: 3 expressions
   Size: 3 expressions
   Size: 3 expressions
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Initializing construction of objective function ...
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Solving capacity expansion model...
> Solving capacity expansion model...
> Solving capacity expansion model...
Problem
Problem
Problem
  Name                   :                 
  Name                   :                 
  Name                   :                 
  Objective sense        : minimize        
  Objective sense        : minimize        
  Objective sense        : minimize        
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Type                   : LO (linear optimization problem)
  Constraints            : 27              
  Constraints            : 27              
  Constraints            : 27              
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Affine conic cons.     : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Disjunctive cons.      : 0               
  Cones                  : 0               
  Cones                  : 0               
  Cones                  : 0               
  Scalar variables       : 28              
  Scalar variables       : 28              
  Scalar variables       : 28              
  Matrix variables       : 0               
  Matrix variables       : 0               
  Matrix variables       : 0               
  Integer variables      : 0               
  Integer variables      : 0               
  Integer variables      : 0               



Optimizer started.
Optimizer started.
Optimizer started.
Presolve started.
Presolve started.
Presolve started.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker started.
Linear dependency checker terminated.
Linear dependency checker terminated.
Linear dependency checker terminated.
Eliminator started.
Eliminator started.
Eliminator started.
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Freed constraints in eliminator : 0
Eliminator terminated.
Eliminator terminated.
Eliminator terminated.
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Eliminator - tries                  : 2                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - tries                  : 1                 time                   : 0.00            
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - primal attempts        : 1                 successes              : 1               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - dual attempts          : 0                 successes              : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Lin. dep.  - primal deps.           : 0                 dual deps.             : 0               
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Presolve terminated. Time: 0.00    
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - threads                : 24              
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - solved problem         : the primal      
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Constraints            : 6               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Cones                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Scalar variables       : 17                conic                  : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Optimizer  - Semi-definite variables: 0                 scalarized             : 0               
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - setup time             : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - dense det. time        : 0.00              GP order time          : 0.00            
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - nonzeros before factor : 12                after factor           : 12              
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
Factor     - dense dim.             : 0                 flops                  : 8.40e+01        
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
0   4.0e+02  6.4e-01  3.9e+01  0.00e+00   2.617340248e+00   1.224328117e+01   4.8e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
1   1.0e+02  1.6e-01  9.7e+00  4.45e+00   1.080609797e+00   2.890636539e+01   1.2e+01  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
2   1.1e+01  1.8e-02  1.1e+00  1.10e+00   6.131011462e-01   3.176584559e+00   1.3e+00  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
3   2.0e+00  3.3e-03  2.0e-01  1.04e+00   2.847588747e-01   7.195862430e-01   2.4e-01  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
4   1.7e-02  2.7e-05  1.6e-03  1.01e+00   2.526901306e-01   2.541590317e-01   2.0e-03  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
5   2.0e-03  3.3e-06  2.0e-04  1.00e+00   2.517658471e-01   2.519162254e-01   2.5e-04  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
6   1.5e-05  2.4e-08  1.4e-06  1.00e+00   2.517019337e-01   2.517030023e-01   1.8e-06  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
7   2.9e-06  4.7e-09  2.8e-07  1.00e+00   2.517002291e-01   2.517003981e-01   3.5e-07  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
8   7.0e-08  1.1e-10  6.8e-09  9.99e-01   2.517000072e-01   2.517000108e-01   8.5e-09  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
9   8.0e-12  1.2e-14  7.3e-13  1.00e+00   2.517000000e-01   2.517000000e-01   9.1e-13  0.00  
Basis identification started.
Basis identification started.
Basis identification started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization started.
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Basis identification initialization terminated. Time: 0.00
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase started.
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Primal basis identification phase terminated. Time: 0.00
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase started.
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Dual basis identification phase terminated. Time: 0.00
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Initialization.                            Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Primal.          Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Dual.            Iterations: 1             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Optimization.    Iterations: 0             Time: 0.00        
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Basis identification terminated. Time: 0.00
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    
Optimizer terminated. Time: 0.00    






Interior-point solution summary
Interior-point solution summary
Interior-point solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 2e-12    var: 0e+00  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  
  Dual.    obj: 2.5170000000e-01    nrm: 5e-03    Viol.  con: 3e-15    var: 4e-15  



Basic solution summary
Basic solution summary
Basic solution summary
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Problem status  : PRIMAL_AND_DUAL_FEASIBLE
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Solution status : OPTIMAL
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Primal.  obj: 2.5170000000e-01    nrm: 2e+02    Viol.  con: 6e-15    var: 0e+00  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
  Dual.    obj: 2.5170071012e-01    nrm: 5e-03    Viol.  con: 0e+00    var: 7e-09  
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Time spent by solver: 0.01 seconds.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Solver finished with status: ok, termination condition: optimal.
> Objective value: 251700.00 USD.
> Objective value: 251700.00 USD.
> Objective value: 251700.00 USD.
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
> Initializing export all results to CSV files ... 
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
- Directory: /Users/psernatorre/Documents/sting/examples/kron_reduction/3bus_in_series/outputs/kron_capacity_expansion
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Initializing generator results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Initializing storage results to CSV files ... 
> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Completed in 0.00 seconds. 

> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Initializing transmission results to CSV files ... 
> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 

> Completed in 0.01 seconds. 


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.


>> Run completed in 0.06 seconds.

